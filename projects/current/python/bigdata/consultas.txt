
Para analizar evento 19 de corner+cabezon

select substr(t.EventTypeID,2) as EventID, substr(t.EventTypeID,1,1) as Goal_Error, t.MatchID, t.Minute, t.SubjectTeamID, x.HomeTeamID, x.AwayTeamID, CASE when t.SubjectTeamID=x.HomeTeamID then x.HomeCAB else x.AwayCAB end as CAB_Subject,  CASE when t.SubjectTeamID=x.HomeTeamID then x.AwayCAB else x.HomeCAB end as CAB_rival, CASE when t.SubjectTeamID=x.HomeTeamID then x.RatingIndirectSetPiecesAttHome else x.RatingIndirectSetPiecesAttHome end as SPInd_Att, CASE when t.SubjectTeamID=x.HomeTeamID then x.RatingIndirectSetPiecesDefAway else x.RatingIndirectSetPiecesDefHome end as SPInd_Def
from eventos as t
left join (select a.MatchID,a.HomeTeamId,a.AwayTeamID,a.RatingIndirectSetPiecesDefHome, a.RatingIndirectSetPiecesAttHome, a.RatingIndirectSetPiecesDefAway, a.RatingIndirectSetPiecesAttAway, case when b.CABS is null then '0' else b.CABS end as HomeCAB,case when c.CABS is null then '0' else c.CABS end as AwayCAB
from partidos as a
left join (select MatchID,RoleTeam,Specialty,count(Player) as CABs
from alineacion_all
group by MatchID,RoleTeam,Specialty
having Specialty='5' and RoleTeam='1') as b ON a.MatchID=b.MatchID
left join (select MatchID,RoleTeam,Specialty,count(Player) as CABs
from alineacion_all
group by MatchID,RoleTeam,Specialty
having Specialty='5' and RoleTeam='2') as c ON a.MatchID=c.MatchID) as x ON t.MatchID=x.MatchID
where EventTypeID = '119' or EventTypeID = '219'
